{"version":3,"sources":["src/poniter.js"],"names":[],"mappings":"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","file":"poniter.js","sourcesContent":["// poniter Copyright 2015 Stuart P. Bentley <https://stuartpb.com>\n// This work may be used freely as long as this notice is included.\n// The work is provided \"as is\" without warranty, express or implied.\n\n(function(){\n\"use strict\";\n\nlet poniter = {};\n\nponiter.listen = function PoniterListener(element) {\n  let trackedPointerStates = new Map();\n  let elementListeners = {};\n\n  function trackedPointerState(pointerId) {\n    let state = trackedPointerStates.get(pointerId);\n    if (state) return state;\n    else {\n      state = {\n        down: false,\n        inside: false,\n        listeners: {}\n      };\n      trackedPointerStates.set(pointerId,state);\n      return state;\n    }\n  }\n\n  function eventProxy(evt, state) {\n    let proxy = Object.create(evt);\n    //proxy.state = state;\n    proxy.down = state.down;\n    if (state.down) {\n      proxy.downX = state.downX;\n      proxy.downY = state.downY;\n    }\n    proxy.inside = state.inside;\n    proxy.pon = (evtName, cb) => {\n      state.listeners[evtName] = cb;\n      return proxy;\n    };\n    return proxy;\n  }\n\n  function fireProxyAtListener(name, evt, state) {\n    if (state.listeners[name]) {\n      state.listeners[name](eventProxy(evt, state));\n    } else if (elementListeners[name]) {\n      elementListeners[name](eventProxy(evt, state));\n    }\n  }\n\n  element.addEventListener('pointerenter', evt => {\n    let state = trackedPointerState(evt.pointerId);\n    state.inside = true;\n    fireProxyAtListener('enter', evt, state);\n  });\n\n  element.addEventListener('pointerover', evt => {\n    let state = trackedPointerState(evt.pointerId);\n    fireProxyAtListener('over', evt, state);\n  });\n\n  element.addEventListener('pointerdown', evt => {\n    let state = trackedPointerState(evt.pointerId);\n    state.down = true;\n    state.downX = evt.clientX;\n    state.downY = evt.clientY;\n    fireProxyAtListener('down', evt, state);\n  });\n\n  element.addEventListener('pointermove', evt => {\n    let state = trackedPointerState(evt.pointerId);\n    fireProxyAtListener('move', evt, state);\n  });\n\n  element.addEventListener('pointerout', evt => {\n    let state = trackedPointerState(evt.pointerId);\n    fireProxyAtListener('out', evt, state);\n  });\n\n  element.addEventListener('pointerup', evt => {\n    let state = trackedPointerState(evt.pointerId);\n    state.down = false;\n    fireProxyAtListener('up', evt, state);\n  });\n\n  element.addEventListener('pointercancel', evt => {\n    let state = trackedPointerState(evt.pointerId);\n    fireProxyAtListener('cancel', evt, state);\n  });\n\n  element.addEventListener('gotpointercapture', evt => {\n    let state = trackedPointerState(evt.pointerId);\n    state.captured = true;\n  });\n\n  element.addEventListener('lostpointercapture', evt => {\n    let state = trackedPointerStates.get(evt.pointerId);\n    if (state) {\n      if (state.inside) state.captured = false;\n      else trackedPointerStates.delete(evt.pointerId);\n    }\n  });\n\n  element.addEventListener('pointerleave', evt => {\n    let state = trackedPointerStates.get(evt.pointerId);\n    if (state) {\n      if (state.captured) {\n        state.inside = false;\n      }\n\n      fireProxyAtListener('leave', evt, state);\n\n      if (!state.captured) {\n        trackedPointerStates.delete(evt.pointerId);\n      }\n    } else if (elementListeners.leave) {\n      elementListeners.leave(evt);\n    }\n  });\n\n  let listenObject = {\n    on: (evtName, cb) => {\n      elementListeners[evtName] = cb;\n      return listenObject;\n    }\n  };\n\n  return listenObject;\n};\n\nif(typeof module != \"undefined\") {\n  module.exports = poniter;\n} else {\n  window.poniter = poniter;\n}\n\n})();\n"]}